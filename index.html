<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SPI</title>
  <meta name="description" content="SPI — Kelompok 5. Tabs: SPI COSO, SPI TI, Simpulan."/>
  <style>
    :root{
      /* Accenture-inspired palette */
      --bg:#0b0b10;           /* primary background */
      --bg-2:#0f0f18;         /* elevated bg */
      --card:#121226;         /* card surface */
      --text:#eae8ff;         /* main text */
      --muted:#b7b3d9;        /* secondary text */
      --accent:#a100ff;       /* accent purple */
      --accent-2:#00e0ff;     /* cyan edge */
      --accent-3:#ff4fd8;     /* magenta pop */
      --ok:#14e07d;
      --warn:#ffc857;
      --danger:#ff4f6d;
      --radius:16px;
      --shadow:0 10px 30px rgba(0,0,0,.35), 0 0 40px rgba(161,0,255,.15);
    }

    html,body{height:100%}
    body{
      margin:0;background:var(--bg);color:var(--text);font:500 16px/1.6 "Inter",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,"Apple Color Emoji","Segoe UI Emoji";
      overflow-x:hidden;
    }

    /* Subtle animated gradient ring around viewport */
    .halo{
      position:fixed;inset:-40vmax;pointer-events:none;z-index:0;
      background: radial-gradient(60vmax 60vmax at 80% 20%, color-mix(in oklab, var(--accent) 45%, transparent), transparent 60%),
                  radial-gradient(70vmax 70vmax at 20% 80%, color-mix(in oklab, var(--accent-2) 40%, transparent), transparent 60%),
                  radial-gradient(80vmax 80vmax at 100% 100%, color-mix(in oklab, var(--accent-3) 35%, transparent), transparent 70%);
      filter: blur(40px) saturate(120%);
      animation: drift 20s linear infinite alternate;
    }
    @keyframes drift{to{transform:translate3d(-2rem,2rem,0) scale(1.02)}}

    .grid{
      position:fixed;inset:0;z-index:0;pointer-events:none;opacity:.2;
      background:
        linear-gradient(transparent 97%, rgba(161,0,255,.25) 98%, transparent 100%) 0 0/100% 22px,
        linear-gradient(90deg, transparent 97%, rgba(0,224,255,.25) 98%, transparent 100%) 0 0/22px 100%;
      mask:linear-gradient(to bottom,transparent,rgba(0,0,0,.7) 25%, rgba(0,0,0,.9) 60%, transparent);
    }

    header{
      position:sticky;top:0;z-index:10;
      backdrop-filter: blur(10px) saturate(130%);
      background: linear-gradient(to bottom, rgba(17,17,30,.7), rgba(17,17,30,.35));
      border-bottom: 1px solid color-mix(in oklab, var(--accent) 22%, transparent);
    }
    .wrap{max-width:1100px;margin:0 auto;padding:18px 20px;}

    .brand{display:flex;align-items:center;gap:14px}
    .logo{
      width:36px;height:36px;border-radius:10px;display:grid;place-items:center;
      background: conic-gradient(from 210deg at 50% 50%, var(--accent), var(--accent-2), var(--accent-3), var(--accent));
      box-shadow: 0 0 25px rgba(161,0,255,.45);
      position:relative;overflow:hidden;
    }
    .logo::after{
      content:"›";font-weight:900;font-size:24px;line-height:1;
      color: white; text-shadow:0 0 8px rgba(255,255,255,.5);
      transform: translateY(-1px);
    }
    .title{font-size:20px;font-weight:800;letter-spacing:.4px}
    .subtitle{color:var(--muted);font-size:12px;margin-top:-6px}

    .k5{display:flex;align-items:center;gap:8px;flex-wrap:wrap;margin-top:10px}
    .chip{padding:6px 10px;border-radius:999px;font-size:12px;color:var(--text);
      background: linear-gradient(180deg, color-mix(in oklab, var(--card) 80%, transparent), color-mix(in oklab, var(--card) 60%, transparent));
      border:1px solid color-mix(in oklab, var(--accent) 25%, transparent);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.03), 0 6px 18px rgba(0,0,0,.25);
    }

    /* Tabs */
    .tabs{margin-top:14px;display:flex;gap:8px;flex-wrap:wrap}
    .tab-btn{position:relative;isolation:isolate;cursor:pointer;border:none;outline:none;padding:10px 14px;border-radius:12px;background: color-mix(in oklab, var(--card) 85%, transparent);color:var(--text);font-weight:700;letter-spacing:.3px;border:1px solid color-mix(in oklab, var(--accent) 20%, transparent);transition: transform .18s ease, border-color .2s ease, background .2s ease;}
    .tab-btn:hover{transform: translateY(-1px)}
    .tab-btn.active{background: linear-gradient(180deg, rgba(161,0,255,.18), rgba(0,224,255,.14));border-color: color-mix(in oklab, var(--accent) 55%, transparent);box-shadow: 0 8px 20px rgba(161,0,255,.25), 0 0 0 1px rgba(255,255,255,.04) inset;}
    .tab-btn .pulse{position:absolute;inset:0;border-radius:inherit;z-index:-1;background: radial-gradient(60% 60% at 50% 50%, rgba(161,0,255,.25), transparent 70%);opacity:0;animation: pulse 2.2s ease-out infinite;}
    .tab-btn.active .pulse{opacity:1}
    @keyframes pulse{50%{transform:scale(1.06)}to{transform:scale(1)}}

    main{position:relative;z-index:1}
    .panel{display:none;opacity:0;transform: translateY(10px) scale(.995);transition: opacity .28s ease, transform .28s ease;background: linear-gradient(180deg, color-mix(in oklab, var(--card) 88%, transparent), color-mix(in oklab, var(--card) 70%, transparent));border:1px solid color-mix(in oklab, var(--accent) 30%, transparent);border-radius: var(--radius);padding:20px; box-shadow: var(--shadow);margin:14px 0 28px;}
    .panel.show{display:block;opacity:1;transform: translateY(0) scale(1)}

    h1{margin:8px 0 6px;font-size:26px}
    h2{margin:6px 0 10px;font-size:18px;color:var(--text)}
    p{margin:0 0 10px;color:var(--muted)}

    table{width:100%;border-collapse:collapse;margin:10px 0;font-size:14px}
    th,td{padding:8px;border-bottom:1px solid rgba(255,255,255,.1)}
    th{text-align:left;color:var(--accent-2)}

    .statrow{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin:14px 0}
    .stat{background:linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.00));border:1px solid rgba(255,255,255,.06);border-radius:14px;padding:14px;position:relative;overflow:hidden}
    .stat b{font-size:18px}
    .stat small{display:block;color:var(--muted)}

    .callout{display:flex;gap:14px;align-items:flex-start;margin-top:6px;padding:12px;border-radius:14px;background:linear-gradient(180deg, rgba(0,224,255,.08), rgba(161,0,255,.08));border:1px dashed color-mix(in oklab, var(--accent) 45%, transparent)}

    footer{opacity:.85;margin:20px 0 40px}
    .foot{display:flex;justify-content:space-between;flex-wrap:wrap;gap:10px;color:var(--muted);font-size:12px}

    .chart-card{margin:14px 0 6px;padding:14px;border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,.02),rgba(255,255,255,.00));border:1px solid rgba(255,255,255,.06)}
    .legend{display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-top:8px;color:var(--muted);font-size:12px}
    .legend .key{display:inline-flex;align-items:center;gap:6px}
    .legend .swatch{width:10px;height:10px;border-radius:2px;box-shadow:0 0 8px rgba(0,0,0,.2)}

    @media (max-width: 860px){.statrow{grid-template-columns:repeat(2,1fr)}}
    @media (max-width: 520px){.statrow{grid-template-columns:1fr}.wrap{padding:16px}h1{font-size:22px}.title{font-size:18px}}
  </style>
</head>
<body>
  <div class="halo" aria-hidden="true"></div>
  <div class="grid" aria-hidden="true"></div>

  <header>
    <div class="wrap">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <div class="title">SPI</div>
          <div class="subtitle">Website Kelompok 5 — SPI</div>
        </div>
      </div>

      <div class="k5" title="Kelompok 5">
        <span class="chip">Derby</span>
        <span class="chip">Fauzul</span>
        <span class="chip">Iqbal</span>
        <span class="chip">Rakyan</span>
        <span class="chip">Surya</span>
      </div>

      <nav class="tabs" role="tablist" aria-label="Tab utama">
        <button class="tab-btn active" role="tab" aria-selected="true" aria-controls="panel-coso" id="tab-coso"><span class="pulse"></span> SPI COSO</button>
        <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-ti" id="tab-ti"><span class="pulse"></span> SPI TI</button>
        <button class="tab-btn" role="tab" aria-selected="false" aria-controls="panel-simpulan" id="tab-simpulan"><span class="pulse"></span> Simpulan Hasil Pemahaman SPI</button>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <!-- PANEL: SPI COSO -->
    <section id="panel-coso" class="panel show" role="tabpanel" aria-labelledby="tab-coso">
      <h1>SPI COSO</h1>
      <p>Tabel hasil penilaian Sistem Pengendalian Intern (SPI) berdasarkan model COSO dengan skor dari auditee dan hasil validasi pemeriksa.</p>

      <table>
        <thead>
          <tr><th>No</th><th>Unsur</th><th style="text-align:right">Skor Auditee</th><th style="text-align:right">Hasil Validasi Pemeriksa</th></tr>
        </thead>
        <tbody>
          <tr><td>1</td><td>Lingkungan Pengendalian</td><td style="text-align:right">2,98</td><td style="text-align:right">2,69</td></tr>
          <tr><td>2</td><td>Penaksiran Risiko</td><td style="text-align:right">2,60</td><td style="text-align:right">2,50</td></tr>
          <tr><td>3</td><td>Aktivitas Pengendalian</td><td style="text-align:right">3,00</td><td style="text-align:right">2,46</td></tr>
          <tr><td>4</td><td>Informasi dan Komunikasi</td><td style="text-align:right">3,00</td><td style="text-align:right">2,15</td></tr>
          <tr><td>5</td><td>Pemantauan</td><td style="text-align:right">3,00</td><td style="text-align:right">2,80</td></tr>
          <tr><td><b>X</b></td><td><b>SKOR RATA-RATA PENILAIAN SPI</b></td><td style="text-align:right"><b>2,92</b></td><td style="text-align:right"><b>2,52</b></td></tr>
        </tbody>
      </table>

      <div class="callout"><b>Interpretasi:</b> Skor rata-rata 2,52 menunjukkan bahwa SPI tingkat entitas (berdasarkan model COSO) tergolong <u>Efektif</u>.</div>

      <div id="coso-chart" class="chart-card" aria-label="Grafik batang skor COSO (Auditee vs Validasi)"></div>
      <div class="legend">
        <span class="key"><span class="swatch" style="background:var(--accent)"></span> Auditee</span>
        <span class="key"><span class="swatch" style="background:var(--accent-2)"></span> Validasi Pemeriksa</span>
        <span class="key">Skala 0–3</span>
      </div>
    </section>

    <!-- PANEL: SPI TI -->
    <section id="panel-ti" class="panel" role="tabpanel" aria-labelledby="tab-ti" hidden>
      <h1>SPI TI (Sistem Informasi)</h1>
      <p>Ringkasan tabel Kuesioner Pengendalian Sistem Informasi — skor auditee vs skor setelah validasi pemeriksa.</p>

      <h2>I. Pengendalian Umum (IT General Controls)</h2>
      <table>
        <thead>
          <tr><th>Sub‑unsur</th><th style="text-align:right">Skor Auditee</th><th style="text-align:right">Skor Validasi</th></tr>
        </thead>
        <tbody>
          <tr><td>A. Administrasi & Fungsi TI</td><td style="text-align:right">2,87</td><td style="text-align:right">2,00</td></tr>
          <tr><td>B. Pemisahan Tugas TI</td><td style="text-align:right">3,00</td><td style="text-align:right">2,20</td></tr>
          <tr><td>C. Pengembangan Sistem</td><td style="text-align:right">3,00</td><td style="text-align:right">2,57</td></tr>
          <tr><td>D. Keamanan Fisik & Online</td><td style="text-align:right">2,85</td><td style="text-align:right">2,08</td></tr>
          <tr><td>E. Back‑up & Contingency</td><td style="text-align:right">2,78</td><td style="text-align:right">2,33</td></tr>
          <tr><td>F. Pengendalian Perangkat Keras</td><td style="text-align:right">2,63</td><td style="text-align:right">1,88</td></tr>
        </tbody>
      </table>

      <h2>II. Pengendalian Aplikasi</h2>
      <table>
        <thead>
          <tr><th>Sub‑unsur</th><th style="text-align:right">Skor Auditee</th><th style="text-align:right">Skor Validasi</th></tr>
        </thead>
        <tbody>
          <tr><td>A. Pengendalian Input</td><td style="text-align:right">2,84</td><td style="text-align:right">2,53</td></tr>
          <tr><td>B. Pengendalian Proses</td><td style="text-align:right">3,00</td><td style="text-align:right">2,38</td></tr>
          <tr><td>C. Pengendalian Output</td><td style="text-align:right">2,87</td><td style="text-align:right">2,19</td></tr>
        </tbody>
        <tfoot>
          <tr><td><b>JUMLAH</b></td><td style="text-align:right"><b>25,83</b></td><td style="text-align:right"><b>20,16</b></td></tr>
          <tr><td><b>Skor Rata‑rata SPI TI (Y)</b></td><td style="text-align:right"><b>2,87</b></td><td style="text-align:right"><b>2,24</b></td></tr>
        </tfoot>
      </table>

      <div class="callout"><b>Kesimpulan Efektivitas SPI TI:</b>&nbsp;<i>Belum Sepenuhnya Efektif</i> (berdasarkan skor validasi 2,24).</div>
    </section>

    <!-- PANEL: SIMPULAN -->
    <section id="panel-simpulan" class="panel" role="tabpanel" aria-labelledby="tab-simpulan" hidden>
      <h1>Simpulan Hasil Pemahaman SPI</h1>
      <p>Rekap skor efektivitas SPI tingkat entitas (COSO) dan SPI Sistem Informasi, beserta klasifikasi efektivitas.</p>

      <table>
        <thead>
          <tr><th>Unsur</th><th style="text-align:right">Skor</th></tr>
        </thead>
        <tbody>
          <tr><td>X — Efektivitas SPI tingkat entitas (COSO)</td><td style="text-align:right">2,52</td></tr>
          <tr><td>Y — Efektivitas SPI Sistem Informasi (TI)</td><td style="text-align:right">2,24</td></tr>
          <tr><td><b>Jumlah (X + Y)</b></td><td style="text-align:right"><b>4,76</b></td></tr>
          <tr><td><b>Rata‑rata ((X+Y)/2)</b></td><td style="text-align:right"><b>2,38</b></td></tr>
        </tbody>
      </table>

      <div class="statrow">
        <div class="stat"><small>Klasifikasi</small><b>Efektif</b><small>2,34 – 3,00</small></div>
        <div class="stat"><small>Klasifikasi</small><b>Belum Sepenuhnya Efektif</b><small>1,67 – 2,33</small></div>
        <div class="stat"><small>Klasifikasi</small><b>Tidak Efektif</b><small>1,00 – 1,66</small></div>
        <div class="stat"><small>Hasil</small><b>2,38</b><small>→ Efektif</small></div>
      </div>

      <div class="callout"><b>Ringkasan:</b>&nbsp;Rata‑rata skor 2,38 mengindikasikan <u>SPI secara keseluruhan Efektif</u>. Area prioritas perbaikan: ITGC (perangkat keras, keamanan/online), pemisahan tugas TI, serta penguatan aktivitas pengendalian pada unit pelaksana.</div>
    </section>

    <footer>
      <div class="foot">
        <div>© <span id="year"></span> Kelompok 5 — SPI</div>
      </div>
    </footer>
  </main>

  <!-- Canvas particles background for subtle tech vibe -->
  <canvas id="fx" style="position:fixed;inset:0;z-index:0;pointer-events:none;mix-blend-mode:screen;opacity:.4"></canvas>

  <script>
    // Tabs logic with accessible state
    const tabs = Array.from(document.querySelectorAll('.tab-btn'));
    const panels = {
      coso: document.getElementById('panel-coso'),
      ti: document.getElementById('panel-ti'),
      simpulan: document.getElementById('panel-simpulan')
    };

    function show(id){
      tabs.forEach(btn=>{
        const isActive = btn.id === 'tab-'+id;
        btn.classList.toggle('active', isActive);
        btn.setAttribute('aria-selected', isActive);
      });
      Object.entries(panels).forEach(([key,el])=>{
        const on = key===id; el.classList.toggle('show', on); el.hidden = !on;
      })
      // Trigger chart render when COSO tab becomes visible
      if(id==='coso') requestAnimationFrame(renderCosoChart);
    }

    tabs.forEach(btn=> btn.addEventListener('click', ()=>{
      const id = btn.id.replace('tab-','');
      show(id);
    }));

    // Keyboard support (left/right)
    document.querySelector('.tabs').addEventListener('keydown', (e)=>{
      const i = tabs.indexOf(document.activeElement);
      if(i<0) return;
      if(e.key==='ArrowRight'){ (tabs[i+1]||tabs[0]).focus(); }
      if(e.key==='ArrowLeft'){ (tabs[i-1]||tabs.at(-1)).focus(); }
      if(e.key==='Enter' || e.key===' '){ document.activeElement.click(); }
    });

    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Intersection fade-up animation
    const io = new IntersectionObserver(entries=>{
      entries.forEach(en=>{
        if(en.isIntersecting){
          en.target.animate([
            {opacity:0, transform:'translateY(10px) scale(.98)'},
            {opacity:1, transform:'translateY(0) scale(1)'}
          ], {duration:480, easing:'cubic-bezier(.2,.7,.2,1)', fill:'forwards'});
          io.unobserve(en.target);
        }
      });
    },{threshold:.12});
    document.querySelectorAll('.stat,.callout').forEach(el=>io.observe(el));

    // Minimal particles network (no external libs)
    const c = document.getElementById('fx');
    const ctx = c.getContext('2d');
    let w,h,pxRatio, nodes;
    function resizeFx(){
      pxRatio = Math.min(window.devicePixelRatio||1, 2);
      w = c.width = innerWidth * pxRatio;
      h = c.height = innerHeight * pxRatio;
      c.style.width = innerWidth+'px';
      c.style.height = innerHeight+'px';
      nodes = Array.from({length: Math.floor((innerWidth*innerHeight)/26000)+24}, ()=>({
        x: Math.random()*w,
        y: Math.random()*h,
        vx: (Math.random()-.5)*.25*pxRatio,
        vy: (Math.random()-.5)*.25*pxRatio
      }));
    }
    resizeFx();
    addEventListener('resize', resizeFx);

    function step(){
      ctx.clearRect(0,0,w,h);
      ctx.fillStyle = 'rgba(161,0,255,.7)';
      nodes.forEach(n=>{ n.x+=n.vx; n.y+=n.vy; if(n.x<0||n.x>w) n.vx*=-1; if(n.y<0||n.y>h) n.vy*=-1; ctx.beginPath(); ctx.arc(n.x, n.y, 1.2*pxRatio, 0, Math.PI*2); ctx.fill(); });
      for(let i=0;i<nodes.length;i++){
        for(let j=i+1;j<nodes.length;j++){
          const a=nodes[i], b=nodes[j];
          const dx=a.x-b.x, dy=a.y-b.y, d=dx*dx+dy*dy;
          if(d< 12000*pxRatio){ const alpha = 1 - d/(12000*pxRatio); ctx.strokeStyle = `rgba(0,224,255,${alpha*.35})`; ctx.beginPath(); ctx.moveTo(a.x,a.y); ctx.lineTo(b.x,b.y); ctx.stroke(); }
        }
      }
      requestAnimationFrame(step);
    }
    requestAnimationFrame(step);

    // === COSO Mini Bar Chart (SVG, no external libs) ===
    const cosoData = [
      {label:'Lingkungan Pengendalian', auditee:2.98, validasi:2.69},
      {label:'Penaksiran Risiko',       auditee:2.60, validasi:2.50},
      {label:'Aktivitas Pengendalian',  auditee:3.00, validasi:2.46},
      {label:'Informasi dan Komunikasi',auditee:3.00, validasi:2.15},
      {label:'Pemantauan',              auditee:3.00, validasi:2.80}
    ];

    function renderCosoChart(){
      const wrap = document.getElementById('coso-chart');
      if(!wrap) return;
      wrap.innerHTML = '';
      const width = Math.max(320, wrap.clientWidth || 860);
      const left = 170, right = 24, top = 18, bottom = 20;
      const barH = 16, pad = 8, groupGap = 12;
      const rows = cosoData.length;
      const height = top + bottom + rows*(barH*2 + pad + groupGap);
      const svgNS = 'http://www.w3.org/2000/svg';
      const svg = document.createElementNS(svgNS,'svg');
      svg.setAttribute('viewBox', `0 0 ${width} ${height}`);
      svg.setAttribute('width','100%');
      svg.setAttribute('height', height);
      const max = 3; const plotW = width - left - right;

      for(let i=0;i<=3;i++){
        const x = left + (plotW)*(i/3);
        const line = document.createElementNS(svgNS,'line');
        line.setAttribute('x1', x); line.setAttribute('x2', x);
        line.setAttribute('y1', top-8); line.setAttribute('y2', height-bottom+6);
        line.setAttribute('stroke','rgba(255,255,255,.08)');
        line.setAttribute('stroke-width','1');
        svg.appendChild(line);
        const tx = document.createElementNS(svgNS,'text');
        tx.setAttribute('x', x); tx.setAttribute('y', top-10);
        tx.setAttribute('text-anchor','middle');
        tx.setAttribute('fill','rgba(255,255,255,.6)');
        tx.setAttribute('font-size','10');
        tx.textContent = i.toString();
        svg.appendChild(tx);
      }

      cosoData.forEach((d, idx)=>{
        const y0 = top + idx*(barH*2 + pad + groupGap);
        const tl = document.createElementNS(svgNS,'text');
        tl.setAttribute('x', left-10); tl.setAttribute('y', y0 + barH + 4);
        tl.setAttribute('text-anchor','end'); tl.setAttribute('fill','rgba(255,255,255,.85)');
        tl.setAttribute('font-size','12'); tl.textContent = d.label;
        svg.appendChild(tl);
        const wA = (d.auditee/max)*plotW; const rA = document.createElementNS(svgNS,'rect');
        rA.setAttribute('x', left); rA.setAttribute('y', y0); rA.setAttribute('width', wA); rA.setAttribute('height', barH); rA.setAttribute('rx','6'); rA.setAttribute('fill','var(--accent)'); svg.appendChild(rA);
        const txA = document.createElementNS(svgNS,'text'); txA.setAttribute('x', left + wA + 6); txA.setAttribute('y', y0 + barH - 3); txA.setAttribute('fill','rgba(255,255,255,.8)'); txA.setAttribute('font-size','11'); txA.textContent = d.auditee.toFixed(2); svg.appendChild(txA);
        const y1 = y0 + barH + pad; const wV = (d.validasi/max)*plotW; const rV = document.createElementNS(svgNS,'rect');
        rV.setAttribute('x', left); rV.setAttribute('y', y1); rV.setAttribute('width', wV); rV.setAttribute('height', barH); rV.setAttribute('rx','6'); rV.setAttribute('fill','var(--accent-2)'); svg.appendChild(rV);
        const txV = document.createElementNS(svgNS,'text'); txV.setAttribute('x', left + wV + 6); txV.setAttribute('y', y1 + barH - 3); txV.setAttribute('fill','rgba(255,255,255,.8)'); txV.setAttribute('font-size','11'); txV.textContent = d.validasi.toFixed(2); svg.appendChild(txV);
      });

      wrap.appendChild(svg);
    }

    // Debounced ResizeObserver to avoid "undelivered notifications"
    let roBusy = false;
    const cosoWrap = document.getElementById('coso-chart');
    const ro = new ResizeObserver(()=>{
      if(roBusy) return; roBusy = true;
      requestAnimationFrame(()=>{ try{ renderCosoChart(); } finally{ roBusy = false; } });
    });
    if(cosoWrap) ro.observe(cosoWrap);

    let winTimer = null;
    window.addEventListener('resize', ()=>{
      if(winTimer) cancelAnimationFrame(winTimer);
      winTimer = requestAnimationFrame(renderCosoChart);
    });

    // Initial paint
    window.addEventListener('load', ()=>{ show('coso'); renderCosoChart(); });
  </script>
</body>
</html>
